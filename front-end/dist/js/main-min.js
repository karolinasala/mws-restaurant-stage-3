let restaurants,neighborhoods,cuisines;var map,markers=[],myLazyLoad=new LazyLoad;document.addEventListener("DOMContentLoaded",e=>{fetchNeighborhoods(),fetchCuisines()}),fetchNeighborhoods=(()=>{DBHelper.fetchNeighborhoods((e,t)=>{null!=e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})}),fillNeighborhoodsHTML=((e=self.neighborhoods)=>{const t=document.getElementById("neighborhoods-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,a.setAttribute("aria-label",e),a.setAttribute("role","option"),t.append(a)})}),fetchCuisines=(()=>{DBHelper.fetchCuisines((e,t)=>{e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})}),fillCuisinesHTML=((e=self.cuisines)=>{const t=document.getElementById("cuisines-select");e.forEach(e=>{const a=document.createElement("option");a.innerHTML=e,a.value=e,a.setAttribute("aria-label",e),a.setAttribute("role","option"),t.append(a)})}),window.initMap=(()=>{self.map=new google.maps.Map(document.getElementById("map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()}),updateRestaurants=(()=>{const e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),a=e.selectedIndex,s=t.selectedIndex,r=e[a].value,n=t[s].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(r,n,(e,t)=>{e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML(),myLazyLoad.update())})}),resetRestaurants=(e=>{self.restaurants=[],document.getElementById("restaurants-list").innerHTML="",self.markers.forEach(e=>e.setMap(null)),self.markers=[],self.restaurants=e}),fillRestaurantsHTML=((e=self.restaurants)=>{const t=document.getElementById("restaurants-list");e.forEach(e=>{t.append(createRestaurantHTML(e))}),addMarkersToMap(),myLazyLoad.update()}),createRestaurantHTML=((e=self.restaurants)=>{const t=document.createElement("li");t.setAttribute("role","listitem");const a=document.createElement("img");a.className="restaurant-img",a.src=DBHelper.imageUrlForRestaurant(e),a.setAttribute("aria-label","img_"+e.id),a.setAttribute("role","img");const s=e.description;a.alt=s,t.append(a);const r=document.createElement("h2");r.innerHTML=e.name,t.append(r);const n=document.createElement("div"),o=document.createElement("span");n.setAttribute("aria-label","favorite heart"),o.classList.add("favorite"),e.is_favorite&&o.classList.add("active"),o.innerHTML="ðŸ–¤",o.setAttribute("id",e.id),o.setAttribute("role","button"),o.title=e.is_favorite?"Remove from Favorites":"Add to Favorites",o.addEventListener("click",toggleFavorite),n.append(o),t.append(o);const i=document.createElement("p");i.innerHTML=e.neighborhood,t.append(i);const l=document.createElement("p");l.innerHTML=e.address,t.append(l);const d=document.createElement("a");return d.innerHTML="View Details",d.setAttribute("aria-label","View restaurant details"),d.setAttribute("role","button"),d.href=DBHelper.urlForRestaurant(e),t.append(d),t});var imageLazyLoad=new LazyLoad({elements_selector:".restaurant-img"});function showMap(){const e=document.getElementById("map"),t=document.getElementById("map-button");e.style.display="block",t.style.display="none"}toggleFavorite=(e=>{const t=Number(e.target.getAttribute("id")),a=!e.target.classList.contains("active");DBHelper.fetchFavorite(t,a).then(t=>{e.target.classList.toggle("active"),e.target.title=t.is_favorite?"Remove from Favorites":"Add to Favorites"})}),addMarkersToMap=((e=self.restaurants)=>{e.forEach(e=>{const t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",()=>{window.location.href=t.url}),self.markers.push(t)})});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicmVzdGF1cmFudHMiLCJuZWlnaGJvcmhvb2RzIiwiY3Vpc2luZXMiLCJtYXAiLCJtYXJrZXJzIiwibXlMYXp5TG9hZCIsIkxhenlMb2FkIiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJmZXRjaEN1aXNpbmVzIiwiREJIZWxwZXIiLCJlcnJvciIsImNvbnNvbGUiLCJzZWxmIiwiZmlsbE5laWdoYm9yaG9vZHNIVE1MIiwic2VsZWN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJmb3JFYWNoIiwibmVpZ2hib3Job29kIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInZhbHVlIiwic2V0QXR0cmlidXRlIiwiYXBwZW5kIiwiZmlsbEN1aXNpbmVzSFRNTCIsImN1aXNpbmUiLCJ3aW5kb3ciLCJpbml0TWFwIiwiZ29vZ2xlIiwibWFwcyIsIk1hcCIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJ1cGRhdGUiLCJtYXJrZXIiLCJzZXRNYXAiLCJ1bCIsInJlc3RhdXJhbnQiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImxpIiwiaW1hZ2UiLCJjbGFzc05hbWUiLCJzcmMiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJpZCIsImFsdE5hbWUiLCJkZXNjcmlwdGlvbiIsImFsdCIsIm5hbWUiLCJmYXZvcml0ZUNvbnRhaW5lciIsImZhdm9yaXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiaXNfZmF2b3JpdGUiLCJ0aXRsZSIsInRvZ2dsZUZhdm9yaXRlIiwiYWRkcmVzcyIsIm1vcmUiLCJocmVmIiwidXJsRm9yUmVzdGF1cmFudCIsImltYWdlTGF6eUxvYWQiLCJlbGVtZW50c19zZWxlY3RvciIsInNob3dNYXAiLCJtcCIsImJ1dHRvbiIsInN0eWxlIiwiZGlzcGxheSIsIk51bWJlciIsInRhcmdldCIsImdldEF0dHJpYnV0ZSIsImNvbnRhaW5zIiwiZmV0Y2hGYXZvcml0ZSIsInRoZW4iLCJyZXNwb25zZSIsInRvZ2dsZSIsIm1hcE1hcmtlckZvclJlc3RhdXJhbnQiLCJhZGRMaXN0ZW5lciIsImxvY2F0aW9uIiwidXJsIiwicHVzaCJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsWUFBYUMsY0FBZUMsU0FDaEMsSUFDSUMsSUFEQUMsUUFBVSxHQUVWQyxXQUFhLElBQUlDLFNBS3JCQyxTQUFTQyxpQkFBaUIsbUJBQXFCQyxJQUM3Q0MscUJBQ0FDLGtCQU1GRCxtQkFBcUIsTUFDbEJFLFNBQVNGLG1CQUFtQixDQUFDRyxFQUFPWixLQUNyQixNQUFUWSxFQUNGQyxRQUFRRCxNQUFNQSxJQUVkRSxLQUFLZCxjQUFnQkEsRUFDckJlLDZCQVFOQSxzQkFBd0IsRUFBQ2YsRUFBZ0JjLEtBQUtkLGlCQUM1QyxNQUFNZ0IsRUFBU1YsU0FBU1csZUFBZSx3QkFDdkNqQixFQUFja0IsUUFBUUMsSUFDcEIsTUFBTUMsRUFBU2QsU0FBU2UsY0FBYyxVQUN0Q0QsRUFBT0UsVUFBWUgsRUFDbkJDLEVBQU9HLE1BQVFKLEVBQ2ZDLEVBQU9JLGFBQWEsYUFBY0wsR0FDbENDLEVBQU9JLGFBQWEsT0FBUSxVQUM1QlIsRUFBT1MsT0FBT0wsT0FPbkJWLGNBQWdCLE1BQ2JDLFNBQVNELGNBQWMsQ0FBQ0UsRUFBT1gsS0FDekJXLEVBQ0ZDLFFBQVFELE1BQU1BLElBRWRFLEtBQUtiLFNBQVdBLEVBQ2hCeUIsd0JBUU5BLGlCQUFtQixFQUFDekIsRUFBV2EsS0FBS2IsWUFDbEMsTUFBTWUsRUFBU1YsU0FBU1csZUFBZSxtQkFDdkNoQixFQUFTaUIsUUFBUVMsSUFDZixNQUFNUCxFQUFTZCxTQUFTZSxjQUFjLFVBQ3RDRCxFQUFPRSxVQUFZSyxFQUNuQlAsRUFBT0csTUFBUUksRUFDZlAsRUFBT0ksYUFBYSxhQUFjRyxHQUNsQ1AsRUFBT0ksYUFBYSxPQUFRLFVBQzVCUixFQUFPUyxPQUFPTCxPQU9uQlEsT0FBT0MsUUFBVSxNQUtmZixLQUFLWixJQUFNLElBQUk0QixPQUFPQyxLQUFLQyxJQUFJMUIsU0FBU1csZUFBZSxPQUFRLENBQzdEZ0IsS0FBTSxHQUNOQyxPQU5RLENBQ1JDLElBQUssVUFDTEMsS0FBTSxXQUtOQyxhQUFhLElBRWZDLHNCQU1GQSxrQkFBb0IsTUFDbEIsTUFBTUMsRUFBVWpDLFNBQVNXLGVBQWUsbUJBQ2xDdUIsRUFBVWxDLFNBQVNXLGVBQWUsd0JBRWxDd0IsRUFBU0YsRUFBUUcsY0FDakJDLEVBQVNILEVBQVFFLGNBRWpCZixFQUFVWSxFQUFRRSxHQUFRbEIsTUFDMUJKLEVBQWVxQixFQUFRRyxHQUFRcEIsTUFFckNaLFNBQVNpQyx3Q0FBd0NqQixFQUFTUixFQUFjLENBQUNQLEVBQU9iLEtBQzFFYSxFQUNGQyxRQUFRRCxNQUFNQSxJQUVkaUMsaUJBQWlCOUMsR0FDakIrQyxzQkFDQTFDLFdBQVcyQyxjQVFqQkYsaUJBQW1CLENBQUM5QyxJQUVsQmUsS0FBS2YsWUFBYyxHQUNSTyxTQUFTVyxlQUFlLG9CQUNoQ0ssVUFBWSxHQUdmUixLQUFLWCxRQUFRZSxRQUFROEIsR0FBVUEsRUFBT0MsT0FBTyxPQUM3Q25DLEtBQUtYLFFBQVUsR0FDZlcsS0FBS2YsWUFBY0EsSUFNcEIrQyxvQkFBc0IsRUFBQy9DLEVBQWNlLEtBQUtmLGVBQ3hDLE1BQU1tRCxFQUFLNUMsU0FBU1csZUFBZSxvQkFDbkNsQixFQUFZbUIsUUFBUWlDLElBQ2xCRCxFQUFHekIsT0FBTzJCLHFCQUFxQkQsTUFFakNFLGtCQUNBakQsV0FBVzJDLFdBTWRLLHFCQUF1QixFQUFDRCxFQUFhckMsS0FBS2YsZUFDeEMsTUFBTXVELEVBQUtoRCxTQUFTZSxjQUFjLE1BQ2xDaUMsRUFBRzlCLGFBQWEsT0FBUSxZQUV4QixNQUFNK0IsRUFBUWpELFNBQVNlLGNBQWMsT0FDckNrQyxFQUFNQyxVQUFZLGlCQUNsQkQsRUFBTUUsSUFBTTlDLFNBQVMrQyxzQkFBc0JQLEdBQzNDSSxFQUFNL0IsYUFBYSxhQUFjLE9BQVMyQixFQUFXUSxJQUNyREosRUFBTS9CLGFBQWEsT0FBUSxPQUMzQixNQUFNb0MsRUFBVVQsRUFBV1UsWUFDM0JOLEVBQU1PLElBQU1GLEVBQ1pOLEVBQUc3QixPQUFPOEIsR0FFVixNQUFNUSxFQUFPekQsU0FBU2UsY0FBYyxNQUNwQzBDLEVBQUt6QyxVQUFZNkIsRUFBV1ksS0FDNUJULEVBQUc3QixPQUFPc0MsR0FFVixNQUFNQyxFQUFvQjFELFNBQVNlLGNBQWMsT0FDM0M0QyxFQUFXM0QsU0FBU2UsY0FBYyxRQUN4QzJDLEVBQWtCeEMsYUFBYSxhQUFjLGtCQUM3Q3lDLEVBQVNDLFVBQVVDLElBQUksWUFDcEJoQixFQUFXaUIsYUFBYUgsRUFBU0MsVUFBVUMsSUFBSSxVQUNsREYsRUFBUzNDLFVBQVksS0FDckIyQyxFQUFTekMsYUFBYSxLQUFNMkIsRUFBV1EsSUFDdkNNLEVBQVN6QyxhQUFhLE9BQVEsVUFDOUJ5QyxFQUFTSSxNQUFTbEIsRUFBc0IsWUFBSSx3QkFBMEIsbUJBQ3RFYyxFQUFTMUQsaUJBQWlCLFFBQVMrRCxnQkFDbkNOLEVBQWtCdkMsT0FBT3dDLEdBQ3pCWCxFQUFHN0IsT0FBT3dDLEdBRVYsTUFBTTlDLEVBQWViLFNBQVNlLGNBQWMsS0FDNUNGLEVBQWFHLFVBQVk2QixFQUFXaEMsYUFDcENtQyxFQUFHN0IsT0FBT04sR0FFVixNQUFNb0QsRUFBVWpFLFNBQVNlLGNBQWMsS0FDdkNrRCxFQUFRakQsVUFBWTZCLEVBQVdvQixRQUMvQmpCLEVBQUc3QixPQUFPOEMsR0FFVixNQUFNQyxFQUFPbEUsU0FBU2UsY0FBYyxLQU9wQyxPQU5BbUQsRUFBS2xELFVBQVksZUFDakJrRCxFQUFLaEQsYUFBYSxhQUFjLDJCQUNoQ2dELEVBQUtoRCxhQUFhLE9BQVEsVUFDMUJnRCxFQUFLQyxLQUFPOUQsU0FBUytELGlCQUFpQnZCLEdBQ3RDRyxFQUFHN0IsT0FBTytDLEdBRUhsQixJQUdULElBQUlxQixjQUFnQixJQUFJdEUsU0FBUyxDQUM3QnVFLGtCQUFtQixvQkErQnRCLFNBQVNDLFVBQ1AsTUFBTUMsRUFBS3hFLFNBQVNXLGVBQWUsT0FDN0I4RCxFQUFTekUsU0FBU1csZUFBZSxjQUN2QzZELEVBQUdFLE1BQU1DLFFBQVUsUUFDbkJGLEVBQU9DLE1BQU1DLFFBQVUsT0FoQzFCWCxlQUFpQixDQUFDOUQsSUFDaEIsTUFBTW1ELEVBQUt1QixPQUFPMUUsRUFBTTJFLE9BQU9DLGFBQWEsT0FDdENoQixHQUFlNUQsRUFBTTJFLE9BQU9qQixVQUFVbUIsU0FBUyxVQUVyRDFFLFNBQVMyRSxjQUFjM0IsRUFBSVMsR0FDMUJtQixLQUFLQyxJQUNKaEYsRUFBTTJFLE9BQU9qQixVQUFVdUIsT0FBTyxVQUM5QmpGLEVBQU0yRSxPQUFPZCxNQUFTbUIsRUFBb0IsWUFBSSx3QkFBMEIsdUJBTzNFbkMsZ0JBQWtCLEVBQUN0RCxFQUFjZSxLQUFLZixlQUNwQ0EsRUFBWW1CLFFBQVFpQyxJQUVsQixNQUFNSCxFQUFTckMsU0FBUytFLHVCQUF1QnZDLEVBQVlyQyxLQUFLWixLQUNoRTRCLE9BQU9DLEtBQUt2QixNQUFNbUYsWUFBWTNDLEVBQVEsUUFBUyxLQUM3Q3BCLE9BQU9nRSxTQUFTbkIsS0FBT3pCLEVBQU82QyxNQUVoQy9FLEtBQUtYLFFBQVEyRixLQUFLOUMiLCJzb3VyY2VzQ29udGVudCI6WyJsZXQgcmVzdGF1cmFudHMsIG5laWdoYm9yaG9vZHMsIGN1aXNpbmVzO1xyXG52YXIgbWFya2VycyA9IFtdO1xyXG52YXIgbWFwO1xyXG52YXIgbXlMYXp5TG9hZCA9IG5ldyBMYXp5TG9hZCgpO1xyXG5cclxuLyoqXHJcbiAqIEZldGNoIG5laWdoYm9yaG9vZHMgYW5kIGN1aXNpbmVzIGFzIHNvb24gYXMgdGhlIHBhZ2UgaXMgbG9hZGVkLlxyXG4gKi9cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIChldmVudCkgPT4ge1xyXG4gIGZldGNoTmVpZ2hib3Job29kcygpO1xyXG4gIGZldGNoQ3Vpc2luZXMoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgYW5kIHNldCB0aGVpciBIVE1MLlxyXG4gKi9cclxuZmV0Y2hOZWlnaGJvcmhvb2RzID0gKCkgPT4ge1xyXG4gICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICAgaWYgKGVycm9yICE9IG51bGwpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICB9IGVsc2Uge1xyXG4gICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgIGZpbGxOZWlnaGJvcmhvb2RzSFRNTCgpO1xyXG4gICAgIH1cclxuICAgfSk7XHJcbiB9XHJcblxyXG4vKipcclxuICogU2V0IG5laWdoYm9yaG9vZHMgSFRNTC5cclxuICovXHJcbiBmaWxsTmVpZ2hib3Job29kc0hUTUwgPSAobmVpZ2hib3Job29kcyA9IHNlbGYubmVpZ2hib3Job29kcykgPT4ge1xyXG4gICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuICAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICAgY29uc3Qgb3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XHJcbiAgICAgb3B0aW9uLmlubmVySFRNTCA9IG5laWdoYm9yaG9vZDtcclxuICAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICAgb3B0aW9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIG5laWdoYm9yaG9vZCk7XHJcbiAgICAgb3B0aW9uLnNldEF0dHJpYnV0ZSgncm9sZScsICdvcHRpb24nKTtcclxuICAgICBzZWxlY3QuYXBwZW5kKG9wdGlvbik7XHJcbiAgIH0pO1xyXG4gfVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBjdWlzaW5lcyBhbmQgc2V0IHRoZWlyIEhUTUwuXHJcbiAqL1xyXG5mZXRjaEN1aXNpbmVzID0gKCkgPT4ge1xyXG4gICBEQkhlbHBlci5mZXRjaEN1aXNpbmVzKChlcnJvciwgY3Vpc2luZXMpID0+IHtcclxuICAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XHJcbiAgICAgfSBlbHNlIHtcclxuICAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgIGZpbGxDdWlzaW5lc0hUTUwoKTtcclxuICAgICB9XHJcbiAgIH0pO1xyXG4gfVxyXG5cclxuLyoqXHJcbiAqIFNldCBjdWlzaW5lcyBIVE1MLlxyXG4gKi9cclxuIGZpbGxDdWlzaW5lc0hUTUwgPSAoY3Vpc2luZXMgPSBzZWxmLmN1aXNpbmVzKSA9PiB7XHJcbiAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgICBvcHRpb24uaW5uZXJIVE1MID0gY3Vpc2luZTtcclxuICAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgIG9wdGlvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBjdWlzaW5lKTtcclxuICAgICBvcHRpb24uc2V0QXR0cmlidXRlKCdyb2xlJywgJ29wdGlvbicpO1xyXG4gICAgIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICAgfSk7XHJcbiB9XHJcblxyXG4vKipcclxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxyXG4gKi9cclxud2luZG93LmluaXRNYXAgPSAoKSA9PiB7XHJcbiAgbGV0IGxvYyA9IHtcclxuICAgIGxhdDogNDAuNzIyMjE2LFxyXG4gICAgbG5nOiAtNzMuOTg3NTAxXHJcbiAgfTtcclxuICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XHJcbiAgICB6b29tOiAxMixcclxuICAgIGNlbnRlcjogbG9jLFxyXG4gICAgc2Nyb2xsd2hlZWw6IGZhbHNlXHJcbiAgfSk7XHJcbiAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZSBwYWdlIGFuZCBtYXAgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMuXHJcbiAqL1xyXG51cGRhdGVSZXN0YXVyYW50cyA9ICgpID0+IHtcclxuICBjb25zdCBjU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2N1aXNpbmVzLXNlbGVjdCcpO1xyXG4gIGNvbnN0IG5TZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKTtcclxuXHJcbiAgY29uc3QgY0luZGV4ID0gY1NlbGVjdC5zZWxlY3RlZEluZGV4O1xyXG4gIGNvbnN0IG5JbmRleCA9IG5TZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuXHJcbiAgY29uc3QgY3Vpc2luZSA9IGNTZWxlY3RbY0luZGV4XS52YWx1ZTtcclxuICBjb25zdCBuZWlnaGJvcmhvb2QgPSBuU2VsZWN0W25JbmRleF0udmFsdWU7XHJcblxyXG4gIERCSGVscGVyLmZldGNoUmVzdGF1cmFudEJ5Q3Vpc2luZUFuZE5laWdoYm9yaG9vZChjdWlzaW5lLCBuZWlnaGJvcmhvb2QsIChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmVzZXRSZXN0YXVyYW50cyhyZXN0YXVyYW50cyk7XHJcbiAgICAgIGZpbGxSZXN0YXVyYW50c0hUTUwoKTtcclxuICAgICAgbXlMYXp5TG9hZC51cGRhdGUoKTtcclxuICAgIH1cclxuICB9KVxyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXIgY3VycmVudCByZXN0YXVyYW50cywgdGhlaXIgSFRNTCBhbmQgcmVtb3ZlIHRoZWlyIG1hcCBtYXJrZXJzLlxyXG4gKi9cclxucmVzZXRSZXN0YXVyYW50cyA9IChyZXN0YXVyYW50cykgPT4ge1xyXG4gIC8vIFJlbW92ZSBhbGwgcmVzdGF1cmFudHNcclxuICBzZWxmLnJlc3RhdXJhbnRzID0gW107XHJcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gIHVsLmlubmVySFRNTCA9ICcnO1xyXG5cclxuICAvLyBSZW1vdmUgYWxsIG1hcCBtYXJrZXJzXHJcbiAgc2VsZi5tYXJrZXJzLmZvckVhY2gobWFya2VyID0+IG1hcmtlci5zZXRNYXAobnVsbCkpO1xyXG4gIHNlbGYubWFya2VycyA9IFtdO1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG4gZmlsbFJlc3RhdXJhbnRzSFRNTCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudHMtbGlzdCcpO1xyXG4gICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgIHVsLmFwcGVuZChjcmVhdGVSZXN0YXVyYW50SFRNTChyZXN0YXVyYW50KSk7XHJcbiAgIH0pO1xyXG4gICBhZGRNYXJrZXJzVG9NYXAoKTtcclxuICAgbXlMYXp5TG9hZC51cGRhdGUoKTtcclxuIH1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBIVE1MLlxyXG4gKi9cclxuY3JlYXRlUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgbGkuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2xpc3RpdGVtJyk7XHJcblxyXG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XHJcbiAgaW1hZ2UuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgaW1hZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgXCJpbWdfXCIgKyByZXN0YXVyYW50LmlkKTtcclxuICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnaW1nJyk7XHJcbiAgY29uc3QgYWx0TmFtZSA9IHJlc3RhdXJhbnQuZGVzY3JpcHRpb247XHJcbiAgaW1hZ2UuYWx0ID0gYWx0TmFtZTtcclxuICBsaS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcclxuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBsaS5hcHBlbmQobmFtZSk7XHJcblxyXG4gIGNvbnN0IGZhdm9yaXRlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgY29uc3QgZmF2b3JpdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XHJcbiAgZmF2b3JpdGVDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgJ2Zhdm9yaXRlIGhlYXJ0Jyk7XHJcbiAgZmF2b3JpdGUuY2xhc3NMaXN0LmFkZCgnZmF2b3JpdGUnKTtcclxuICBpZihyZXN0YXVyYW50LmlzX2Zhdm9yaXRlKSBmYXZvcml0ZS5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTtcclxuICBmYXZvcml0ZS5pbm5lckhUTUwgPSAn8J+WpCc7XHJcbiAgZmF2b3JpdGUuc2V0QXR0cmlidXRlKCdpZCcsIHJlc3RhdXJhbnQuaWQpO1xyXG4gIGZhdm9yaXRlLnNldEF0dHJpYnV0ZSgncm9sZScsICdidXR0b24nKTtcclxuICBmYXZvcml0ZS50aXRsZSA9IChyZXN0YXVyYW50LmlzX2Zhdm9yaXRlKSA/ICdSZW1vdmUgZnJvbSBGYXZvcml0ZXMnIDogJ0FkZCB0byBGYXZvcml0ZXMnO1xyXG4gIGZhdm9yaXRlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdG9nZ2xlRmF2b3JpdGUpO1xyXG4gIGZhdm9yaXRlQ29udGFpbmVyLmFwcGVuZChmYXZvcml0ZSk7XHJcbiAgbGkuYXBwZW5kKGZhdm9yaXRlKTtcclxuXHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xyXG4gIG5laWdoYm9yaG9vZC5pbm5lckhUTUwgPSByZXN0YXVyYW50Lm5laWdoYm9yaG9vZDtcclxuICBsaS5hcHBlbmQobmVpZ2hib3Job29kKTtcclxuXHJcbiAgY29uc3QgYWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcclxuICBsaS5hcHBlbmQoYWRkcmVzcyk7XHJcblxyXG4gIGNvbnN0IG1vcmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XHJcbiAgbW9yZS5pbm5lckhUTUwgPSAnVmlldyBEZXRhaWxzJztcclxuICBtb3JlLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsICdWaWV3IHJlc3RhdXJhbnQgZGV0YWlscycpO1xyXG4gIG1vcmUuc2V0QXR0cmlidXRlKCdyb2xlJywgJ2J1dHRvbicpO1xyXG4gIG1vcmUuaHJlZiA9IERCSGVscGVyLnVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCk7XHJcbiAgbGkuYXBwZW5kKG1vcmUpXHJcblxyXG4gIHJldHVybiBsaTtcclxufVxyXG5cclxudmFyIGltYWdlTGF6eUxvYWQgPSBuZXcgTGF6eUxvYWQoe1xyXG4gICAgZWxlbWVudHNfc2VsZWN0b3I6IFwiLnJlc3RhdXJhbnQtaW1nXCJcclxufSk7XHJcblxyXG50b2dnbGVGYXZvcml0ZSA9IChldmVudCkgPT4ge1xyXG4gIGNvbnN0IGlkID0gTnVtYmVyKGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2lkJykpO1xyXG4gIGNvbnN0IGlzX2Zhdm9yaXRlID0gIWV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaEZhdm9yaXRlKGlkLCBpc19mYXZvcml0ZSlcclxuICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7XHJcbiAgICBldmVudC50YXJnZXQudGl0bGUgPSAocmVzcG9uc2UuaXNfZmF2b3JpdGUpID8gJ1JlbW92ZSBmcm9tIEZhdm9yaXRlcycgOiAnQWRkIHRvIEZhdm9yaXRlcyc7XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCBtYXJrZXJzIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzIHRvIHRoZSBtYXAuXHJcbiAqL1xyXG4gYWRkTWFya2Vyc1RvTWFwID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgIC8vIEFkZCBtYXJrZXIgdG8gdGhlIG1hcFxyXG4gICAgIGNvbnN0IG1hcmtlciA9IERCSGVscGVyLm1hcE1hcmtlckZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2VsZi5tYXApO1xyXG4gICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBtYXJrZXIudXJsXHJcbiAgICAgfSk7XHJcbiAgICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICAgfSk7XHJcbiB9XHJcblxyXG4gLyoqXHJcbiAgKiBTaG93IG1hcCBhZnRlciBvbmNsaWNrIGV2ZW50XHJcbiAgKi9cclxuIGZ1bmN0aW9uIHNob3dNYXAoKSB7XHJcbiAgIGNvbnN0IG1wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIik7XHJcbiAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwibWFwLWJ1dHRvblwiKTtcclxuICAgbXAuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgYnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuIH1cclxuIl0sImZpbGUiOiJtYWluLW1pbi5qcyJ9
